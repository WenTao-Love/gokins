(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19281dcc"],{"065a":function(t,a,e){"use strict";e("edf4")},"2f14":function(t,a,e){"use strict";e.d(a,"a",(function(){return i}));var i=function(t){var a=!1;try{window.getSelection().removeAllRanges()}catch(i){console.log(i)}var e=document.createElement("textarea");e.value=t,document.body.appendChild(e);try{e.select(),a=document.execCommand("copy",!1,null)}catch(i){console.log(i)}return document.body.removeChild(e),a}},4798:function(t,a,e){},"6e8b":function(t,a,e){"use strict";e("a7db")},8382:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",[a("CCard",[a("CCardHeader",[a("CIcon",{attrs:{name:"cil-devices"}}),t._v("  "),a("strong",[t._v(t._s(t.info.name))]),a("div",{staticClass:"card-header-actions"},[1==t.perm.adm?a("CButton",{attrs:{size:"sm",color:"primary",variant:"outline"},on:{click:function(a){t.selPip=!0}}},[t._v(" 添加流水线 ")]):t._e(),t._v("   "),1==t.uinfo.permPipe&&1==t.perm.adm?a("CButton",{attrs:{size:"sm",color:"info",variant:"outline"},on:{click:function(a){return t.$router.push("/pipeline/new/".concat(t.info.aid))}}},[t._v(" 新建流水线 ")]):t._e(),t._v("   "),1==t.perm.write?a("CButton",{attrs:{size:"sm",color:"info",variant:"outline"},on:{click:function(a){t.arteditr=null,t.selArt=!0}}},[t._v(" 新建制品库 ")]):t._e()],1)],1),a("CCardBody",[a("CTabs",{attrs:{activeTab:t.actTab,variant:"pills",vertical:{navs:"col-md-2",content:"col-md-10"}}},[a("CTab",{attrs:{active:""}},[a("template",{slot:"title"},[a("CIcon",{attrs:{name:"cil-calculator"}}),t._v(" 流水线 ")],1),a("CCard",[a("CCardBody",[a("PipelistView",{attrs:{orgId:t.info.aid+"",items:t.pipeitems,loading:t.loading},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[1==t.perm.exec?a("CButton",{staticClass:"pipeBtn",attrs:{color:"info",variant:"outline",square:"",size:"sm"},on:{click:function(a){return a.stopPropagation(),t.run(i.id)}}},[t._v(" 运行 ")]):t._e(),1==t.perm.adm?a("CButton",{staticClass:"pipeBtn",attrs:{color:"danger",size:"sm"},on:{click:function(a){return a.stopPropagation(),t.rmPipeFun(i.id)}}},[t._v(" 移除 ")]):t._e()]}}])}),a("CPagination",{staticStyle:{float:"right","margin-top":"20px"},attrs:{activePage:t.pipepage,pages:t.pipepages},on:{"update:activePage":t.getPipeList}})],1)],1)],2),a("CTab",[a("template",{slot:"title"},[a("CIcon",{attrs:{name:"cil-calculator"}}),t._v(" 制品库 ")],1),a("CCard",[a("CCardBody",[a("ArtlistView",{attrs:{items:t.artitems,loading:t.loadings},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[1==t.perm.write?a("CButton",{staticClass:"pipeBtn",attrs:{color:"info",variant:"outline",square:"",size:"sm"},on:{click:function(a){a.stopPropagation(),t.arteditr=i,t.selArt=!0}}},[t._v(" 修改 ")]):t._e(),1==t.perm.write?a("CButton",{staticClass:"pipeBtn",attrs:{color:"danger",size:"sm"},on:{click:function(a){return a.stopPropagation(),t.rmArtFun(i.id)}}},[t._v(" 删除 ")]):t._e()]}}])}),a("CPagination",{staticStyle:{float:"right","margin-top":"20px"},attrs:{activePage:t.pipepage,pages:t.pipepages},on:{"update:activePage":t.getPipeList}})],1)],1)],2),a("CTab",[a("template",{slot:"title"},[a("CIcon",{attrs:{name:"cil-calculator"}}),t._v(" 成员 ")],1),a("CCard",{attrs:{"accent-color":"primary"}},[a("CCardHeader",[a("strong",[t._v("所有者")])]),a("CCardBody",[a("div",[a("div",{staticClass:"c-avatar"},[a("img",{staticClass:"c-avatar-img",attrs:{src:"/jjenkins/gokinsui/imgs/avatars/def.png"}})]),t._v(" "+t._s(t.user.nick)+" ")])])],1),a("CCard",{attrs:{"accent-color":"primary"}},[a("CCardHeader",[a("strong",[t._v("管理员")]),t._v(" "),a("small",{staticStyle:{color:"#aaa"}},[t._v("可管理 组织,流水线,制品库")]),a("div",{staticClass:"card-header-actions"},[1==t.perm.own?a("CButton",{attrs:{size:"sm",color:"info",variant:"outline"},on:{click:function(a){t.selAdm=!0}}},[t._v(" 新增用户 ")]):t._e()],1)]),a("CCardBody",[a("div",{staticClass:"org-users"},t._l(this.adms,(function(e){return a("div",{key:"adm:"+e.id,staticClass:"item"},[a("div",{staticClass:"tools"},[a("div",{staticClass:"c-avatar"},[a("img",{staticClass:"c-avatar-img",attrs:{src:"/jjenkins/gokinsui/imgs/avatars/def.png"}})])]),a("div",{staticClass:"tools"},[t._v(t._s(e.nick))]),a("div",{staticClass:"tools"},[1==t.perm.own?a("CButton",{attrs:{color:"danger",size:"sm"},on:{click:function(a){return t.rmUserFun(e.id)}}},[a("CIcon",{attrs:{content:t.$options.coreics["cilXCircle"]}}),t._v("移除 ")],1):t._e()],1)])})),0)])],1),a("CCard",{attrs:{"accent-color":"primary"}},[a("CCardHeader",[a("strong",[t._v("普通用户")]),t._v(" "),a("small",{staticStyle:{color:"#aaa"}},[t._v("只能操作 流水线,制品库")]),a("div",{staticClass:"card-header-actions"},[1==t.perm.adm?a("CButton",{attrs:{size:"sm",color:"info",variant:"outline"},on:{click:function(a){t.selUsr=!0}}},[t._v(" 新增用户 ")]):t._e()],1)]),a("CCardBody",[a("div",{staticClass:"org-users"},t._l(this.usrs,(function(e){return a("div",{key:"adm:"+e.id,staticClass:"item"},[a("div",{staticClass:"tools"},[a("div",{staticClass:"c-avatar"},[a("img",{staticClass:"c-avatar-img",attrs:{src:"/jjenkins/gokinsui/imgs/avatars/def.png"}})])]),a("div",{staticClass:"tools"},[t._v(t._s(e.nick))]),a("div",{staticClass:"tools"},[a("div",[a("CBadge",{attrs:{color:"info"}},[t._v(t._s(1==e.permRw?"可编辑":"不可编辑"))])],1),a("div",[a("CBadge",{attrs:{color:"info"}},[t._v(t._s(1==e.permExec?"可执行":"不可执行"))])],1),a("div",[a("CBadge",{attrs:{color:"info"}},[t._v(t._s(1==e.permDown?"可下载":"不可下载"))])],1)]),a("div",{staticClass:"tools"},[1==t.perm.adm?a("CButton",{attrs:{color:"warning",size:"sm"},on:{click:function(a){return t.upPermFun(e)}}},[a("CIcon",{attrs:{content:t.$options.coreics["cilPenAlt"]}})],1):t._e(),1==t.perm.adm?a("CButton",{attrs:{color:"danger",size:"sm"},on:{click:function(a){return t.rmUserFun(e.id)}}},[a("CIcon",{attrs:{content:t.$options.coreics["cilXCircle"]}})],1):t._e()],1)])})),0)])],1)],2),a("CTab",[a("template",{slot:"title"},[a("CIcon",{attrs:{name:"cil-calculator"}}),t._v(" 变量 ")],1),1==t.perm.write?a("CCard",[a("CCardHeader",[t._v(" 变量 "),a("div",{staticClass:"card-header-actions"},[a("CButton",{attrs:{size:"sm",color:"info",variant:"outline"},on:{click:function(a){return t.openVars()}}},[t._v(" 添加变量 ")])],1)]),a("CCardBody",[a("CDataTable",{attrs:{items:t.varItems,fields:t.varFields,pagination:""},scopedSlots:t._u([{key:"public",fn:function(t){var e=t.item;return[a("td",[e.public?a("CIcon",{staticStyle:{color:"#52c41a"},attrs:{name:"cil-check-circle"}}):a("CIcon",{staticStyle:{color:"#ff0042"},attrs:{name:"cil-x-circle"}})],1)]}},{key:"del",fn:function(e){var i=e.item;return[a("td",[a("CButton",{staticClass:"pipeBtn",attrs:{color:"info",variant:"outline",square:"",size:"sm"},on:{click:function(a){return t.editVar(i)}}},[t._v(" 编辑 ")]),a("CButton",{staticClass:"pipeBtn",staticStyle:{"margin-left":"5px"},attrs:{color:"warning",variant:"outline",square:"",size:"sm"},on:{click:function(a){return t.delVar(i)}}},[t._v(" 移除 ")])],1)]}}],null,!1,1999061746)}),a("CPagination",{attrs:{activePage:t.varPage,pages:t.varPages,size:"sm",align:"center"},on:{"update:activePage":[function(a){t.varPage=a},t.getVars],"update:active-page":function(a){t.varPage=a}}})],1)],1):a("CCard",[a("CCardHeader",[t._v("变量")]),a("CCardBody",[a("CDataTable",{attrs:{items:t.varItems,fields:t.infoVarFields,pagination:""},scopedSlots:t._u([{key:"public",fn:function(t){var e=t.item;return[a("td",[e.public?a("CIcon",{staticStyle:{color:"#52c41a"},attrs:{name:"cil-check-circle"}}):a("CIcon",{staticStyle:{color:"#ff0042"},attrs:{name:"cil-x-circle"}})],1)]}}])}),a("CPagination",{attrs:{activePage:t.varPage,pages:t.varPages,size:"sm",align:"center"},on:{"update:activePage":[function(a){t.varPage=a},t.getVars],"update:active-page":function(a){t.varPage=a}}})],1)],1)],2),1==t.perm.adm?a("CTab",[a("template",{slot:"title"},[a("CIcon",{attrs:{name:"cil-calculator"}}),t._v(" 设置 ")],1),a("CCard",{attrs:{"accent-color":"primary"}},[a("CCardHeader",[a("strong",[t._v("信息 ")])]),a("CCardBody",[a("CRow",[a("CCol",{attrs:{sm:"12"}},[a("CInput",{attrs:{label:"名称",placeholder:"请输入组织名称"},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}})],1)],1),a("CRow",[a("CCol",{attrs:{sm:"12"}},[a("CTextarea",{attrs:{label:"描述",placeholder:"请输入组织描述",rows:"10"},model:{value:t.formData.desc,callback:function(a){t.$set(t.formData,"desc",a)},expression:"formData.desc"}})],1)],1),a("CRow",[a("CCol",{attrs:{sm:"6"}},[a("CInputCheckbox",{attrs:{label:"公开",checked:t.formData.public},on:{"update:checked":function(a){return t.$set(t.formData,"public",a)}}})],1)],1),a("CRow",{staticClass:"subRow"},[a("CCol",{attrs:{sm:"6"}},[a("CButton",{attrs:{color:"info"},on:{click:function(a){return t.subFun()}}},[t._v("保存")])],1)],1)],1)],1),a("CCard",{attrs:{"accent-color":"danger"}},[a("CCardHeader",{staticStyle:{"background-color":"#ffe8e6"}},[a("strong",[t._v("危险操作区")])]),a("CCardBody",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{flex:"1"}},[a("h5",[t._v("删除组织")]),a("p",[t._v("组织删除之后无法恢复.请谨慎操作")])]),a("div",[a("CButton",{attrs:{color:"danger",variant:"outline",square:""},on:{click:t.rmOrgFun}},[t._v(" 删除组织 ")])],1)])],1)],2):t._e()],1)],1)],1),1==t.perm.write?a("EditArt",{attrs:{shown:t.selArt,orgId:t.info.id,info:t.arteditr},on:{"update:shown":function(a){t.selArt=a},subOk:t.editArtOkFun}}):t._e(),1==t.perm.adm?a("SelectPipe",{attrs:{shown:t.selPip},on:{"update:shown":function(a){t.selPip=a},addFun:t.addPipFun}}):t._e(),1==t.perm.own?a("SelectUser",{attrs:{shown:t.selAdm},on:{"update:shown":function(a){t.selAdm=a},addFun:t.addAdmFun}}):t._e(),1==t.perm.adm?a("SelectUser",{attrs:{shown:t.selUsr},on:{"update:shown":function(a){t.selUsr=a},addFun:t.addUsrFun}}):t._e(),a("OrgUserPerm",{attrs:{shown:t.selPerm,perm:t.curPerm},on:{"update:shown":function(a){t.selPerm=a},subFun:t.upUsrPermFun}}),a("SelectBranches",{attrs:{shown:t.selectShow,id:t.pipelineId,orgId:t.info.aid+""},on:{"update:shown":function(a){t.selectShow=a}}}),a("CModal",{attrs:{title:"添加变量",show:t.varsShow,centered:!0},on:{"update:show":t.closeVars},scopedSlots:t._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{color:"warning"},on:{click:t.closeVars}},[t._v("关闭")]),a("CButton",{attrs:{color:"info"},on:{click:t.addVars}},[t._v("确定")])]},proxy:!0}])},[a("div",[a("CRow",[a("CCol",[a("CInput",{attrs:{label:"变量名称: ",placeholder:"请输入变量名称"},model:{value:t.vars.name,callback:function(a){t.$set(t.vars,"name",a)},expression:"vars.name"}})],1),a("CCol",[a("CInput",{attrs:{label:"值: ",placeholder:"请输入变量的值"},model:{value:t.vars.value,callback:function(a){t.$set(t.vars,"value",a)},expression:"vars.value"}})],1)],1),a("CRow",[a("CCol",[a("CInput",{attrs:{label:"备注: ",placeholder:"请输入备注"},model:{value:t.vars.remarks,callback:function(a){t.$set(t.vars,"remarks",a)},expression:"vars.remarks"}})],1)],1),a("CRow",[a("CCol",[a("div",{staticStyle:{display:"flex"}},[t._v(" 私密 "),a("CSwitch",{staticClass:"mx-1",attrs:{color:"primary",shape:"pill",checked:t.vars.public},on:{"update:checked":function(a){return t.$set(t.vars,"public",a)}}})],1)])],1)],1)])],1)},n=[],s=e("841cd"),r=e("7606"),o=e("f632"),c=function(){var t=this,a=t._self._c;return a("div",[a("ul",{staticClass:"tlist"},t._l(t.items,(function(e){return a("li",{key:"art:"+e.id,on:{click:function(a){return t.$router.push("/art/info/".concat(e.aid))}}},[a("div",{staticClass:"tit"},[a("div",{staticClass:"tits"},[t._v(" "+t._s(e.name)+" ")]),a("div",{staticClass:"ids",on:{click:function(a){return a.stopPropagation(),t.copyIds(e.identifier)}}},[a("i",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip.hover.click",value:"复制制品库ID",expression:"'复制制品库ID'",modifiers:{hover:!0,click:!0}}],staticClass:"iconfont icon-bianhao"})]),"1"==e.disabled?a("div",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip.hover.click",value:"无法在上传制品",expression:"'无法在上传制品'",modifiers:{hover:!0,click:!0}}],staticClass:"tips"},[t._v(" 已归档 ")]):t._e(),a("div",{staticStyle:{flex:"1"}}),a("div",{staticClass:"tipln"},[a("i",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip.hover.click",value:"制品数量",expression:"'制品数量'",modifiers:{hover:!0,click:!0}}],staticClass:"iconfont icon-zhipinku"}),t._v("  "+t._s(e.artln)+" ")]),t._t("default",null,{item:e})],2),a("div",{staticClass:"infos"},[e.desc&&""!=e.desc?a("div",{staticClass:"fg"},[t._v(t._s(e.desc))]):t._e(),a("div",{staticClass:"fg"},[t._v(t._s(t.$dateFmt(e.created)))]),e.build&&""!=e.build.id?a("div",{staticClass:"fg"},[t._v("上一次构建: "+t._s(t.$dateFmt(e.build.created)))]):t._e(),a("div",{staticStyle:{flex:"1"}}),t._v(" 创建者:  "),a("myavatar",{staticClass:"avat",attrs:{src:e.avat,nick:e.nick,imgw:"18px"}})],1)])})),0),t.loading?a("div",{staticClass:"loadingCont"},[a("div",{staticStyle:{flex:"1"}}),t._m(0),a("div",[t._v("加载中")]),a("div",{staticStyle:{flex:"1"}})]):!t.items||t.items.length<=0?a("div",{staticClass:"emptyCont"},[a("i",{staticClass:"iconfont icon-jinzhide"}),t._v("没有内容")]):t._e()])},l=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"rotateDiv"},[a("i",{staticClass:"iconfont icon-Loadingalt2"})])}],u=e("2f14"),d=e("7150"),f={components:{myavatar:d["a"]},props:{items:Array,loading:Boolean},data:function(){return{}},methods:{copyIds:function(t){Object(u["a"])(t)?this.$msgOk("已成功复制制品库ID"):this.$msgErr("复制制品库ID失败")}}},p=f,m=(e("065a"),e("f900")),v=Object(m["a"])(p,c,l,!1,null,"dbbca710",null),h=v.exports,g=e("4055"),C=e("e27f"),b=function(){var t=this,a=t._self._c;return a("CModal",{attrs:{title:"选择流水线",size:"lg",show:t.shown},on:{"update:show":function(a){return t.$emit("update:shown",a)}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{color:"warning"},on:{click:function(a){return t.$emit("update:shown",!1)}}},[t._v("关闭")])]},proxy:!0}])},[a("CDataTable",{ref:"table",attrs:{hover:!0,striped:!0,border:!0,small:!0,fixed:!0,fields:t.fields,items:t.items},scopedSlots:t._u([{key:"btns",fn:function(e){var i=e.item;return[a("td",{staticClass:"py-2"},[a("CButton",{attrs:{color:"info",square:"",size:"sm",disabled:1==i.added},on:{click:function(a){return t.addFun(i)}}},[t._v(" 添加 ")])],1)]}}])}),a("CPagination",{staticStyle:{float:"right"},attrs:{activePage:t.page,pages:t.pages},on:{"update:activePage":t.getList}})],1)},_=[],k={props:{shown:Boolean},watch:{shown:function(t){1==t&&this.getList(0)}},data:function(){return{fields:[{key:"id",label:"id"},{key:"name",label:"名称"},{key:"displayName",label:"描述"},{key:"btns",label:"操作",sorter:!1,filter:!1}],items:[],page:0,pages:0}},methods:{getList:function(t){var a=this;Object(s["G"])({page:t}).then((function(t){a.page=t.data.page,a.pages=t.data.pages,a.items=t.data.data})).catch((function(t){return Object(s["gb"])(a,t)}))},addFun:function(t){var a=this;this.$emit("addFun",t.id,(function(e){1==e&&(t.added=!0,a.$refs.table.$forceUpdate())}))}}},w=k,y=Object(m["a"])(w,b,_,!1,null,null,null),x=y.exports,P=function(){var t=this,a=t._self._c;return a("CModal",{attrs:{title:"选择用户",size:"lg",show:t.shown},on:{"update:show":function(a){return t.$emit("update:shown",a)}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{color:"warning"},on:{click:function(a){return t.$emit("update:shown",!1)}}},[t._v("关闭")])]},proxy:!0}])},[a("CDataTable",{ref:"table",attrs:{hover:!0,striped:!0,border:!0,small:!0,fixed:!0,fields:t.fields,items:t.items},scopedSlots:t._u([{key:"aid",fn:function(e){var i=e.item;return[a("td",{staticStyle:{"text-align":"center"}},[t._v(" "+t._s(i.aid)+" ")])]}},{key:"nick",fn:function(t){var e=t.item;return[a("td",[a("myavatar",{attrs:{src:e.avat,nick:e.nick,imgw:"18px"}})],1)]}},{key:"created",fn:function(e){var i=e.item;return[a("td",[t._v(" "+t._s(t.$dateFmt(i.created))+" ")])]}},{key:"btns",fn:function(e){var i=e.item;return[a("td",{staticClass:"py-2"},[a("CButton",{attrs:{color:"info",square:"",size:"sm",disabled:1==i.added},on:{click:function(a){return t.addFun(i)}}},[t._v(" 添加 ")])],1)]}}])}),a("CPagination",{staticStyle:{float:"right"},attrs:{activePage:t.page,pages:t.pages},on:{"update:activePage":t.getList}})],1)},$=[],O={components:{myavatar:d["a"]},props:{shown:Boolean},watch:{shown:function(t){1==t&&this.getList(0)}},data:function(){return{fields:[{key:"aid",label:"序号",_style:"width:80px;text-align:center"},{key:"name",label:"用户名"},{key:"nick",label:"昵称"},{key:"created",label:"创建时间"},{key:"btns",label:"操作",sorter:!1,filter:!1}],items:[],page:0,pages:0}},methods:{getList:function(t){var a=this;Object(s["cb"])({page:t}).then((function(t){a.page=t.data.page,a.pages=t.data.pages,a.items=t.data.data})).catch((function(t){return Object(s["gb"])(a,t)}))},addFun:function(t){var a=this;this.$emit("addFun",t.id,(function(e){1==e&&(t.added=!0,a.$refs.table.$forceUpdate())}))}}},S=O,j=Object(m["a"])(S,P,$,!1,null,null,null),B=j.exports,D=function(){var t=this,a=t._self._c;return a("CModal",{attrs:{title:"选择权限",size:"sm",show:t.shown},on:{"update:show":function(a){return t.$emit("update:shown",a)}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{color:"warning",variant:"outline"},on:{click:function(a){return t.$emit("update:shown",!1)}}},[t._v("取消")]),a("CButton",{attrs:{color:"info"},on:{click:function(a){return t.$emit("subFun",t.formData)}}},[t._v("提交")])]},proxy:!0}])},[a("CInputCheckbox",{attrs:{label:"编辑权限",checked:t.formData.rw},on:{"update:checked":function(a){return t.$set(t.formData,"rw",a)}}}),a("CInputCheckbox",{attrs:{label:"执行权限",checked:t.formData.exec},on:{"update:checked":function(a){return t.$set(t.formData,"exec",a)}}}),a("CInputCheckbox",{attrs:{label:"下载制品权限",checked:t.formData.down},on:{"update:checked":function(a){return t.$set(t.formData,"down",a)}}})],1)},I=[],F={props:{shown:Boolean,perm:Object},watch:{shown:function(t){1==t&&(this.formData.id=this.perm.id,this.formData.rw=this.perm.rw,this.formData.exec=this.perm.exec,this.formData.down=this.perm.down)}},data:function(){return{formData:{}}}},z=F,V=Object(m["a"])(z,D,I,!1,null,null,null),A=V.exports,U={coreics:r["a"],components:{ArtlistView:h,PipelistView:o["a"],EditArt:C["a"],SelectPipe:x,SelectUser:B,OrgUserPerm:A,SelectBranches:g["a"]},data:function(){return{actTab:0,info:{},user:{},adms:[],usrs:[],loading:!0,pipepage:0,pipepages:0,pipeitems:[],loadings:!0,artpage:0,artpages:0,artitems:[],arteditr:null,perm:{},formData:{id:"",name:"",desc:"",public:!1},pipelineId:"",selArt:!1,selPip:!1,selAdm:!1,selUsr:!1,selPerm:!1,selectShow:!1,curPerm:{rw:!1,exec:!1,down:!1},varItems:[],varPage:0,varPages:0,varFields:[{key:"name",label:"名称"},{key:"value",label:"值"},{key:"remarks",label:"备注"},{key:"public",label:"私密"},{key:"del",label:"操作",sorter:!1,filter:!1}],infoVarFields:[{key:"name",label:"名称"},{key:"value",label:"值"},{key:"remarks",label:"备注"},{key:"public",label:"私密"}],varsShow:!1,vars:{public:!0,remarks:"",value:"",name:""}}},computed:{uinfo:function(){return this.$store.state.uinfo||{}}},mounted:function(){null!=this.$route.params&&null!=this.$route.params.id&&""!=this.$route.params.id?this.getInfo(this.$route.params.id):this.$router.push("/404")},methods:{getInfo:function(t){var a=this;this.loading=!0,Object(s["t"])(t).then((function(t){a.info=t.data.org,a.user=t.data.user,a.perm=t.data.perm,a.formData.id=a.info.id,a.formData.name=a.info.name,a.formData.desc=a.info.desc,a.formData.public=1==a.info.public,a.getUserList(),a.getPipeList(),a.getArtList(),a.getVars()})).catch((function(t){return Object(s["gb"])(a,t)}))},run:function(t){this.pipelineId=t,this.selectShow=!0},getUserList:function(){var t=this;Object(s["D"])(this.info.id).then((function(a){t.adms=a.data.adms||[],t.usrs=a.data.usrs||[]})).catch((function(a){return Object(s["gb"])(t,a)}))},goVersion:function(t){this.$router.push("/pipeline/build/".concat(t))},getPipeList:function(t){var a=this;this.loading=!0,Object(s["y"])({page:t,orgId:this.info.id}).then((function(t){a.loading=!1,a.pipepage=t.data.page,a.pipepages=t.data.pages,a.pipeitems=t.data.data})).catch((function(t){return Object(s["gb"])(a,t)}))},getArtList:function(t){var a=this;this.loadings=!0,Object(s["c"])({page:t,orgId:this.info.id}).then((function(t){a.loadings=!1,a.artpage=t.data.page,a.artpages=t.data.pages,a.artitems=t.data.data})).catch((function(t){return Object(s["gb"])(a,t)}))},goEdit:function(t){this.$router.push("/pipeline/info/".concat(t))},subFun:function(){var t=this;if(""==this.formData.name)return console.log("name"),void this.$msgErr("请输入名称");Object(s["A"])(this.formData).then((function(){t.$msgOk("保存成功")})).catch((function(a){return Object(s["gb"])(t,a)}))},addPipFun:function(t,a){var e=this;Object(s["w"])(this.info.id,t).then((function(){e.actTab=0,a(!0),e.getPipeList(),e.$msgOk("添加成功")})).catch((function(t){return Object(s["gb"])(e,t,(function(t){a(!1);var i=t.response?t.response.status:0;511==i&&(a(!0),e.$msgErr("流水线已存在"))}))}))},rmPipeFun:function(t){var a=this;this.$confirm('确定从组织移除此流水线吗?<p style="color:#aaa">流水线不会被删除</p>',null,(function(){Object(s["x"])(a.info.id,t).then((function(){a.getPipeList(),a.$msgOk("操作成功")})).catch((function(t){return Object(s["gb"])(a,t)}))}))},addAdmFun:function(t,a){var e=this;console.log("addAdmFun",t),Object(s["B"])({add:!0,id:this.info.id,uid:t,adm:!0}).then((function(){a(!0),e.getUserList(),e.$msgOk("添加成功")})).catch((function(t){return Object(s["gb"])(e,t,(function(){a(!1)}))}))},addUsrFun:function(t,a){var e=this;console.log("addUserFun",t),Object(s["B"])({add:!0,id:this.info.id,uid:t,adm:!1}).then((function(){a(!0),e.getUserList(),e.$msgOk("添加成功,请稍后给予权限")})).catch((function(t){return Object(s["gb"])(e,t,(function(){a(!1)}))}))},rmUserFun:function(t){var a=this;this.$confirm("确定从组织移除此成员吗?",null,(function(){Object(s["C"])(a.info.id,t).then((function(){a.getUserList()})).catch((function(t){return Object(s["gb"])(a,t)}))}))},upPermFun:function(t){this.curPerm={id:t.id,rw:1==t.permRw,exec:1==t.permExec,down:1==t.permDown},this.selPerm=!0},upUsrPermFun:function(t){var a=this;console.log("upUsrPermFun",t),Object(s["B"])({id:this.info.id,uid:t.id,adm:!1,rw:t.rw,ex:t.exec,dw:t.down}).then((function(t){a.selPerm=!1,a.getUserList(),a.$msgOk("修改成功")})).catch((function(t){return Object(s["gb"])(a,t)}))},rmOrgFun:function(){var t=this;this.$confirm("确定删除组织吗?",null,(function(){Object(s["z"])(t.info.id).then((function(){t.$router.push("/org/")})).catch((function(a){return Object(s["gb"])(t,a)}))}))},editArtOkFun:function(){this.actTab=1,this.getArtList(this.artpage)},rmArtFun:function(t){var a=this;this.$confirm("确定删除制品库吗?可能将无法找回其下所有制品!",null,(function(){Object(s["e"])(t).then((function(){a.getArtList(a.artpage)})).catch((function(t){return Object(s["gb"])(a,t)}))}))},getVars:function(){var t=this;Object(s["E"])({orgId:this.info.id,page:this.varPage}).then((function(a){for(var e in t.varItems=[],a.data.data){var i=a.data.data[e];i.public=1==i.public}t.varPage=a.data.page,t.varPages=a.data.pages,t.varItems=a.data.data})).catch((function(a){Object(s["gb"])(t,a)}))},openVars:function(){this.vars={public:!0,remarks:"",value:"",name:""},this.varsShow=!0},closeVars:function(){this.vars={public:!0,remarks:"",value:"",name:""},this.varsShow=!1},addVars:function(){this.vars.name&&""!=this.vars.name?this.vars.value&&""!=this.vars.value?(this.saveVars(),this.getVars()):this.$msgErr("请输入值"):this.$msgErr("请输入变量名")},delVar:function(t){this.deletedPipelineVars(t.aid)},editVar:function(t){void 0!=t&&null!=t&&(this.vars={aid:t.aid,public:t.public,remarks:t.remarks,value:t.value,name:t.name},this.backVar=t),this.varsShow=!0},saveVars:function(){var t=this,a=this.vars;a.orgId=this.info.id,Object(s["R"])(a).then((function(a){t.closeVars(),t.getVars()})).catch((function(a){Object(s["gb"])(t,a)}))},deletedVars:function(t){var a=this;this.$confirm("确定删除变量?",null,(function(){Object(s["l"])({aid:t}).then((function(t){a.$msgOk("删除成功"),a.closeVars(),a.getVars()})).catch((function(t){Object(s["gb"])(a,t)}))}))}}},L=U,T=(e("6e8b"),Object(m["a"])(L,i,n,!1,null,"708c99e4",null));a["default"]=T.exports},a7db:function(t,a,e){},cccb:function(t,a,e){"use strict";e("4798")},e27f:function(t,a,e){"use strict";var i=function(){var t=this,a=t._self._c;return a("CModal",{attrs:{title:"编辑制品库",closeOnBackdrop:!1,show:t.shown},on:{"update:show":function(a){return t.$emit("update:shown",a)}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{color:"warning",variant:"outline"},on:{click:function(a){return t.$emit("update:shown",!1)}}},[t._v("取消")]),a("CButton",{attrs:{color:"info",disabled:t.subing},on:{click:t.subFun}},[t._v("提交")])]},proxy:!0}])},[a("CInput",{attrs:{label:"名称",placeholder:"请输入名称(必填)"},model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}}),a("div",{staticStyle:{"margin-bottom":"10px",display:"flex"}},[a("div",{staticStyle:{"line-height":"27x"}},[t._v("是否已归档:    ")]),a("CSwitch",{attrs:{color:"info",variant:"3d",checked:t.formData.disabled},on:{"update:checked":function(a){return t.$set(t.formData,"disabled",a)}}})],1),a("CTextarea",{attrs:{label:"描述",placeholder:"请输入描述",rows:"10"},model:{value:t.formData.desc,callback:function(a){t.$set(t.formData,"desc",a)},expression:"formData.desc"}})],1)},n=[],s=e("841cd"),r={props:{shown:Boolean,orgId:String,info:Object},watch:{shown:function(t){if(1==t){if(!this.orgId)return void this.$emit("update:shown",!1);this.subing=!1,this.formData={name:"",disabled:!1,desc:""},this.info&&this.info.id&&""!=this.info.id&&(this.formData.id=this.info.id,this.formData.name=this.info.name,this.formData.disabled=1==this.info.disabled,this.formData.desc=this.info.desc)}}},data:function(){return{subing:!1,formData:{}}},methods:{subFun:function(){var t=this;this.formData.name?(this.subing=!0,this.formData.orgId=this.orgId,Object(s["a"])(this.formData).then((function(a){t.$emit("update:shown",!1),t.$emit("subOk",a.data)})).catch((function(a){return Object(s["gb"])(t,a,(function(){t.subing=!1}))}))):this.$msgErr("用户名必填")}}},o=r,c=e("f900"),l=Object(c["a"])(o,i,n,!1,null,null,null);a["a"]=l.exports},edf4:function(t,a,e){},f632:function(t,a,e){"use strict";var i=function(){var t=this,a=t._self._c;return a("div",[a("ul",{staticClass:"tlist"},t._l(t.items,(function(e){return a("li",{key:"pipe:"+e.id,on:{click:function(a){return t.goPipline(e.id)}}},[a("div",{staticClass:"tit"},[e.build&&""!=e.build.id?a("div",{staticClass:"icons rotateDiv"},["ok"==e.build.status?a("i",{staticClass:"iconfont icon-success color-success",staticStyle:{"font-size":"20px"}}):"error"==e.build.status?a("i",{staticClass:"iconfont icon-chacha color-error",staticStyle:{"font-size":"20px"}}):"cancel"==e.build.status?a("i",{staticClass:"iconfont icon-jinzhide color-cancel",staticStyle:{"font-size":"20px"}}):a("i",{staticClass:"iconfont icon-jiazaizhong color-runing",staticStyle:{"font-size":"18px"}})]):t._e(),a("div",{staticClass:"tits"},[t._v(" "+t._s(e.name)+" "),e.displayName&&""!=e.displayName?a("span",[t._v(t._s(e.displayName))]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.public,expression:"item.public=='1'"},{name:"c-tooltip",rawName:"v-c-tooltip.hover.click",value:"所有人可查看相关流水线",expression:"'所有人可查看相关流水线'",modifiers:{hover:!0,click:!0}}],staticClass:"tips"},[t._v(" 公开 ")]),a("div",{staticStyle:{flex:"1"}}),a("div",{staticClass:"tipln"},[a("i",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip.hover.click",value:"构建次数",expression:"'构建次数'",modifiers:{hover:!0,click:!0}}],staticClass:"iconfont icon-build"}),t._v("  "+t._s(e.buildln)+" ")]),t._t("default",null,{item:e})],2),a("div",{staticClass:"infos"},[a("div",{staticClass:"fg"},[t._v(t._s(t.$dateFmt(e.created)))]),e.build&&""!=e.build.id?a("div",{staticClass:"fg"},[t._v("上一次构建: "+t._s(t.$dateFmt(e.build.created)))]):t._e(),a("div",{staticStyle:{flex:"1"}}),t._v(" 创建者:  "),a("myavatar",{staticClass:"avat",attrs:{src:e.avat,nick:e.nick,imgw:"18px"}})],1)])})),0),t.loading?a("div",{staticClass:"loadingCont"},[a("div",{staticStyle:{flex:"1"}}),t._m(0),a("div",[t._v("加载中")]),a("div",{staticStyle:{flex:"1"}})]):!t.items||t.items.length<=0?a("div",{staticClass:"emptyCont"},[a("i",{staticClass:"iconfont icon-jinzhide"}),t._v("没有内容")]):t._e()])},n=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"rotateDiv"},[a("i",{staticClass:"iconfont icon-Loadingalt2"})])}],s=e("7150"),r={components:{myavatar:s["a"]},props:{items:Array,loading:Boolean,orgId:String},data:function(){return{}},methods:{goPipline:function(t){this.orgId&&""!=this.orgId?this.$router.push("/pipeline/info/".concat(t,"?org=").concat(this.orgId)):this.$router.push("/pipeline/info/".concat(t))}}},o=r,c=(e("cccb"),e("f900")),l=Object(c["a"])(o,i,n,!1,null,"fccf39e6",null);a["a"]=l.exports}}]);
//# sourceMappingURL=chunk-19281dcc.97553c0a.js.map